---
title: "Levon_Gevorgyan_Homework_1"
output:
  pdf_document: default
  html_document: default
date: "2025-02-02"
---

```{r}
library(dplyr)
library(readr)
```


## Part 1

1. Load the dataset. Check the first 5 rows.

```{r}
df <- read_csv("/Users/levongevorgyan/Desktop/DataVisualization/crime_data.csv")
head(df, 5)
```


2. Identify columns with missing values and their respective counts. 
Drop columns where more than 50% of the data is missing (store this version as a 
new dataset).

```{r}
null_sum <- colSums(is.na(df))  
null <- missing_count[null_sum > 0]

print(missing_cols)
```


3. Convert the DATE OCC column to a datetime format. Extract the year, month, 
and day into separate columns. Create a new column for the hour using the 
TIME OCC column.

```{r}
df$DATE_OCC <- as.Date(df$`DATE OCC`, format = "%m/%d/%Y")

df$Year <- format(df$DATE_OCC, "%Y")
df$Month <- format(df$DATE_OCC, "%m")
df$Day <- format(df$DATE_OCC, "%d")

df$TIME_OCC <- sprintf("%04d", as.integer(df$`TIME OCC`))
df$Hour <- as.integer(substr(df$TIME_OCC, 1, 2))

str(df) #checking if it conveted correctly

# DATE_OCC: Date[1:50000], format: "2024-08-01" "2023-09-15" "2023-06-26" - 
# means now it's in date format
```


4. Filter the dataset for crimes that occurred in 2023. Further filter crimes 
with the description BURGLARY in the Crm Cd Desc column.

```{r}
df_filtered <- df[df$DATE_OCC >= "2023-01-01" & df$DATE_OCC <= "2023-12-31" & 
                    df$`Crm Cd Desc` == "BURGLARY", ]
head(df_filtered)
```


5. Group the data by AREA NAME and calculate the total number of crimes and the 
average victim age. Sort the results by total crimes in descending order.

```{r}
df %>%
  group_by(`AREA NAME`) %>%
  summarise(
    total_crimes = n(),
    avg_victim_age = mean(`Vict Age`, na.rm = TRUE)
  ) %>%
  arrange(desc(total_crimes))
```


## Part 3

1. Group the data by Month and count the number of crimes.

```{r}
df %>%
  mutate(Month = substr(DATE_OCC, 6, 7)) %>% #taking only the month part from 
                                                                        #date
  group_by(Month) %>%
  summarise(crimes_count = n()) %>%
  arrange(Month)
```


2. Count the number of crimes where a weapon was used (Weapon Used Cd is not 
                                                                          null).

```{r}
crimes_count <- df %>%
  filter(!is.na(`Weapon Used Cd`)) %>%
  summarise(total_crimes_with_weapon = n())

print(paste("The total number of crimes where weapon where used is:", 
            crimes_count))
```


3. Group the data by Premis Desc and count the number of crimes.

```{r}
df %>%
  group_by(`Premis Desc`) %>%
  summarise(crimes_count = n())
```


## Part 4

Create a new column, Severity Score, based on the following rules:

- Assign 5 points if a weapon was used (Weapon Used Cd is not null).
- Assign 3 points for crimes under BURGLARY.
- Assign 1 point for all other crimes.
- Group by AREA NAME and find the total severity score for each area.

```{r}
severity_scores <- df %>%
  mutate(Severity_Score = case_when(
    !is.na(`Weapon Used Cd`) ~ 5,
    `Crm Cd Desc` == "BURGLARY" ~ 3,  
    TRUE ~ 1
  )) %>%
  group_by(`AREA NAME`) %>%
  summarise(Total_Severity_Score = sum(Severity_Score, na.rm = TRUE))

print(severity_scores)
```
                                                                          
                                                                          
                                                                          